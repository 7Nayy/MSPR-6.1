# Corriger le fichier agent.yml avec vos vraies valeurs
cat > monitoring/grafana-agent/agent.yml << 'EOF'
server:
  http_listen_port: 12345

metrics:
  wal_directory: /tmp/grafana-agent-wal
  global:
    scrape_interval: 30s
    external_labels:
      cluster: 'wildaware-prod'
      environment: 'production'

  configs:
  - name: wildaware
    remote_write:
    - url: https://prometheus-prod-01-eu-west-0.grafana.net/api/prom/push
      basic_auth:
        username: '1006356'
        password: 'glc_eyJvIjoiMTAwNjM1NiIsIm4iOiJzdGFjay04MDcwMzktaG0tcmVhZC1tc3ByX21ldHJpY3MiLCJrIjoiODg2ME9GbDI3SG5LemtjMnVjaWM5RDgzIiwibSI6eyJyIjoicHJvZC1ldS13ZXN0LTIifX0='
    
    scrape_configs:
    - job_name: 'wildaware-app'
      static_configs:
      - targets: ['wildaware-exporter:9090']
      scrape_interval: 30s
      
    - job_name: 'node-exporter'
      static_configs:
      - targets: ['node-exporter:9100']
      scrape_interval: 30s
EOF